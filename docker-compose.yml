version: "3.7"

services:
  landing_mongo:
    image: mongo
    container_name: landing_mongo
    restart: unless-stopped
    env_file:
      - .env
    volumes:
      - "./data:/data/db"
  landing_roll_over:
    build: .
    container_name: landing_roll_over
    working_dir: /frontend
    command: node build
    restart: unless-stopped
    ports:
      - "3011:3000"
    env_file:
      - .env
    depends_on:
      - landing_mongo
    environment:
      - DEV_MODE=false
  landing_roll_over_1:
    build: .
    container_name: landing_roll_over_1
    working_dir: /frontend
    command: node build
    restart: unless-stopped
    ports:
      - "3012:3000"
    env_file:
      - .env
    depends_on:
      - landing_mongo
    environment:
      - DEV_MODE=false
  preview_generator:
    build: ./apps/preview-generator
    container_name: preview_generator
    command: uvicorn main:app --host 0.0.0.0
    working_dir: /backend/src      
  mongo_express:
    image: mongo-express
    env_file:
      - .env
    depends_on:
      - landing_mongo_dev
    restart: unless-stopped
    ports:
      - "127.0.0.1:8088:8081"    